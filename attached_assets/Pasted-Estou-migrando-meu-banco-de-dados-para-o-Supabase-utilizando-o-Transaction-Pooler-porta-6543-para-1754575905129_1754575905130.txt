Estou migrando meu banco de dados para o Supabase, utilizando o Transaction Pooler (porta 6543) para compatibilidade com IPv4 no Replit. Preciso que voc√™ atualize completamente o app para funcionar com esse novo banco.
________________________________________
üß± 1. ATUALIZAR CONEX√ÉO DO DRIZZLE ORM
‚û§ Substituir a conex√£o local pelo Supabase:
‚Ä¢	Atualize a inst√¢ncia do pg.Pool para usar a vari√°vel DATABASE_URL do .env.
‚Ä¢	Certifique-se de que todos os lugares que usam o banco (Drizzle) estejam apontando para essa nova inst√¢ncia.
ts
CopiarEditar
// Exemplo:
import { Pool } from 'pg';
import { drizzle } from 'drizzle-orm/node-postgres';
import 'dotenv/config';

const pool = new Pool({ connectionString: process.env.DATABASE_URL });
export const db = drizzle(pool);
________________________________________
üß™ 2. VARI√ÅVEL DE AMBIENTE NO .ENV
Garanta que o arquivo .env contenha a seguinte vari√°vel:
env
CopiarEditar
DATABASE_URL=postgresql://postgres.wxyz:Dev@1206@aws-xxx.supabase.co:6543/postgres
‚ö†Ô∏è N√£o coloque colchetes ‚Äî use a senha real.
________________________________________
üîÅ 3. APLICAR MIGRA√á√ïES NO NOVO BANCO
‚û§ Execute:
bash
CopiarEditar
npx drizzle-kit push
‚Ä¢	Isso cria as tabelas no banco do Supabase.
‚Ä¢	Se der erro, verifique se a conex√£o est√° correta.
________________________________________
üîê 4. AUTENTICA√á√ÉO DE USU√ÅRIOS
O app atual usava autentica√ß√£o local. Desejo que:
‚û§ Adapte a l√≥gica para:
‚Ä¢	Usar Supabase apenas como banco de dados
‚Ä¢	Manter login local com email e senha funcionando (via Drizzle + bcrypt)
‚Ä¢	OU integrar login com Google OAuth (se poss√≠vel) com Supabase Auth
Se for usado Supabase Auth, armazenar nome, email e role manualmente na tabela users ap√≥s o login com Google.
________________________________________
üìÅ 5. SUGEST√ÉO DE ARQUIVOS OBSOLETOS PARA LIMPAR
Se o login via Google substituir a l√≥gica local, sugiro excluir:
‚Ä¢	Helpers de bcrypt, jsonwebtoken
‚Ä¢	Middlewares de autentica√ß√£o local, se n√£o forem mais usados
‚Ä¢	Rotas antigas de login/cadastro (/auth/login, /auth/register), se migrar tudo para Supabase Auth
Pe√ßa confirma√ß√£o antes de excluir.
________________________________________
‚úÖ OBJETIVO FINAL
‚Ä¢	O banco de dados deve funcionar perfeitamente com Supabase (porta 6543)
‚Ä¢	O Drizzle deve estar totalmente conectado ao Supabase
‚Ä¢	Login e cria√ß√£o de usu√°rios devem persistir dados no Supabase
‚Ä¢	A cria√ß√£o de servi√ßos (title, serviceType) deve funcionar sem erros
‚Ä¢	Dados devem ser vis√≠veis e gerenci√°veis pelo painel web do Supabase
‚Ä¢	O .env deve estar configurado corretamente
________________________________________
Se precisar, posso informar a senha do banco para colocar diretamente no .env.
Me avise se for necess√°rio criar os schemas ou se o assistente pode inferir com base nos arquivos existentes.
